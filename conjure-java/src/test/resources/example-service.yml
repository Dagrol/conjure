types:
  imports:
    ResourceIdentifier:
      base-type: string
      external: 
        java: com.palantir.ri.ResourceIdentifier
    
    AuthHeader:
      base-type: string
      external:
        java: com.palantir.tokens.auth.AuthHeader

    Safe:
      external:
        java: com.palantir.redaction.Safe

  definitions:
    default-package: com.palantir.foundry.catalog.api
    objects:      
      BackingFileSystem:
        package: com.palantir.foundry.catalog.api.datasets
        fields:
          fileSystemId:
            type: string
            docs: The name by which this file system is identified.
          baseUri: string
          configuration: map<string, string>
  
      Dataset:
        package: com.palantir.foundry.catalog.api.datasets
        fields:
          fileSystemId: string
          rid:
            type: ResourceIdentifier
            docs: Uniquely identifies this dataset.
          
      CreateDatasetRequest:
        fields:
          fileSystemId: string
          path: string

services:
  TestService:
    name: Test Service
    package: test.api
    default-auth: header
    base-path: /catalog
    docs: |
      A Markdown description of the service.

    endpoints:
      getFileSystems:
        http: GET /fileSystems
        returns: map<string, BackingFileSystem>
        docs: |
          Returns a mapping from file system id to backing file system configuration.
          
      createDataset:
        http: POST /datasets
        args:
          request: CreateDatasetRequest
        returns: Dataset

      getDataset:
        http: GET /datasets/{datasetRid}
        args:
          datasetRid:
            type: ResourceIdentifier
            markers:
             - Safe
        returns: optional<Dataset>

      getRawData:
        http: GET /datasets/{datasetRid}/raw
        args:
          datasetRid:
            type: ResourceIdentifier
            markers:
             - Safe
        returns: binary

      maybeGetRawData:
        http: GET /datasets/{datasetRid}/raw-maybe
        args:
          datasetRid:
            type: ResourceIdentifier
            markers:
             - Safe
        returns: optional<binary>
        
      getBranches:
        http: GET /datasets/{datasetRid}/branches
        args:
          datasetRid:
            type: ResourceIdentifier
            docs: |
              A valid dataset resource identifier.
            markers:
             - Safe
        returns: set<string>
      getBranchesDeprecated:
        http: GET /datasets/{datasetRid}/branchesDeprecated
        args:
          datasetRid:
            type: ResourceIdentifier
            docs: |
              A valid dataset resource identifier.
            markers:
             - Safe
        returns: set<string>
        docs: |
          Gets all branches of this dataset.
        deprecated: use getBranches instead

      resolveBranch:
        http: GET /datasets/{datasetRid}/branches/{branch:.+}/resolve
        args:
          datasetRid:
            type: ResourceIdentifier
            markers:
             - Safe
          branch: string
        returns: optional<string>

      testParam:
        http: GET /datasets/{dataset-rid}/testParam
        args:
          datasetRid:
            type: ResourceIdentifier
            param-id: dataset-rid
            param-type: path
        returns: optional<string>
