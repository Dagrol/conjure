import { ICreateDatasetRequest } from "./createDatasetRequest";
import { IHttpApiBridge } from "@foundry/conjure-fe-lib";
import { IBackingFileSystem } from "@palantir/foundry-catalog-api-datasets";
import { IDataset } from "@palantir/foundry-catalog-api-datasets";

export class TestService {
    private bridge: IHttpApiBridge;

    constructor(
        bridge: IHttpApiBridge
    ) {
        this.bridge = bridge;
    }

    public createDataset(
        request: ICreateDatasetRequest
    ): Promise<IDataset> {
        return this.bridge.callEndpoint<IDataset>({
            data: request,
            endpointName: "createDataset",
            endpointPath: "/catalog/datasets",
            method: "POST",
            pathArguments: [
            ],
            queryArguments: {
            },
            requestMediaType: "application/json",
            requiredHeaders: [
                "Authorization",
            ],
            responseMediaType: "application/json",
        });
    }

    public emptyDocs(): Promise<void> {
        return this.bridge.callEndpoint<void>({
            data: undefined,
            endpointName: "emptyDocs",
            endpointPath: "/catalog/documentation",
            method: "GET",
            pathArguments: [
            ],
            queryArguments: {
            },
            requestMediaType: "application/json",
            requiredHeaders: [
                "Authorization",
            ],
            responseMediaType: "application/json",
        });
    }

    public getBranches(
        datasetRid: string
    ): Promise<string[]> {
        return this.bridge.callEndpoint<string[]>({
            data: undefined,
            endpointName: "getBranches",
            endpointPath: "/catalog/datasets/{datasetRid}/branches",
            method: "GET",
            pathArguments: [
                datasetRid,
            ],
            queryArguments: {
            },
            requestMediaType: "application/json",
            requiredHeaders: [
                "Authorization",
            ],
            responseMediaType: "application/json",
        });
    }

    public getDataset(
        datasetRid: string
    ): Promise<IDataset> {
        return this.bridge.callEndpoint<IDataset>({
            data: undefined,
            endpointName: "getDataset",
            endpointPath: "/catalog/datasets/{datasetRid}",
            method: "GET",
            pathArguments: [
                datasetRid,
            ],
            queryArguments: {
            },
            requestMediaType: "application/json",
            requiredHeaders: [
                "Authorization",
            ],
            responseMediaType: "application/json",
        });
    }

    public getFileSystems(): Promise<{ [key: string]: IBackingFileSystem }> {
        return this.bridge.callEndpoint<{ [key: string]: IBackingFileSystem }>({
            data: undefined,
            endpointName: "getFileSystems",
            endpointPath: "/catalog/fileSystems",
            method: "GET",
            pathArguments: [
            ],
            queryArguments: {
            },
            requestMediaType: "application/json",
            requiredHeaders: [
                "Authorization",
            ],
            responseMediaType: "application/json",
        });
    }

    public paginateSomething(
        pageSize: number,
        pageToken?: string
    ): Promise<void> {
        return this.bridge.callEndpoint<void>({
            data: undefined,
            endpointName: "paginateSomething",
            endpointPath: "/catalog/datasets/some-page",
            method: "GET",
            pathArguments: [
            ],
            queryArguments: {
                pageSize: pageSize,
                pageToken: pageToken,
            },
            requestMediaType: "application/json",
            requiredHeaders: [
                "Authorization",
            ],
            responseMediaType: "application/json",
        });
    }

    public uploadRawData(
        input: any
    ): Promise<void> {
        return this.bridge.callEndpoint<void>({
            data: input,
            endpointName: "uploadRawData",
            endpointPath: "/catalog/datasets/upload-raw",
            method: "POST",
            pathArguments: [
            ],
            queryArguments: {
            },
            requestMediaType: "application/octet-stream",
            requiredHeaders: [
                "Authorization",
            ],
            responseMediaType: "application/json",
        });
    }
}
